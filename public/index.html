<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BRB Bull Run Boost Shadow Markets</title>
    <link rel="stylesheet" href="css/fonts.css">
    <link rel="stylesheet" href="css/styles.css">
    <!-- Share Tech Mono font for tutorials -->
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
</head>
<body>
    <div id="game-container">
        <!-- Game will be rendered here by Phaser -->
    </div>

    <!-- UI Elements that will appear over the game -->
    <div id="ui-container">
        <!-- Main Menu -->
        <div id="main-menu" class="screen">
            <h1 id="game-title">
                <img src="img/brb-logo.png" alt="Bull Run Boost Logo" class="game-logo" style="width: 36px; height: auto; vertical-align: middle; margin-right: 10px; display: inline-block;">
                BRB Bull Run Boost
            </h1>
            <h2>Shadow Markets</h2>
            
            <div class="input-group">
                <label for="player-name">Your Name:</label>
                <input type="text" id="player-name" placeholder="Enter your name" value="Cowboy">
            </div>
            
            <div class="archetype-selection">
                <h3>Choose Your Archetype:</h3>
                <div class="archetype-options">
                    <div class="archetype-card selected" data-archetype="Entrepreneur">
                        <h4>Entrepreneur</h4>
                        <div class="archetype-icon">üíº</div>
                        <p>+10% $CATTLE earning rate</p>
                    </div>
                    <div class="archetype-card" data-archetype="Adventurer">
                        <h4>Adventurer</h4>
                        <div class="archetype-icon">ü§†</div>
                        <p>+10% heist success rate</p>
                    </div>
                </div>
            </div>
            
            <button id="start-game" class="primary-button">Start Game</button>
        </div>
        
        <!-- Ranch Scene UI -->
        <div id="ranch-ui" class="screen hidden">
            <div class="header">
                <div class="time-indicator day" id="ranch-title">
                    <img src="img/brb-logo.png" alt="BRB Logo" class="game-logo" style="width: 24px; height: auto; vertical-align: middle; margin-right: 8px; display: inline-block;">
                    <div class="icon">‚òÄÔ∏è</div>
                    <div class="label">Cipher Gulch - Day</div>
                </div>
                <div class="resources">
                    <div class="resource">
                        <span class="resource-label">$CATTLE:</span>
                        <span class="resource-value" id="cattle-balance">100</span>
                    </div>
                    <div class="resource">
                        <span class="resource-label">Hay:</span>
                        <span class="resource-value" id="hay">100</span>/<span id="barn-capacity">100</span>
                    </div>
                    <div class="resource">
                        <span class="resource-label">Water:</span>
                        <span class="resource-value" id="water">100</span>/<span id="barn-capacity-2">100</span>
                    </div>
                </div>
            </div>
            
            <div class="main-content-layout">
                <!-- Main Pasture Grid Section -->
                <div class="main-section">
                    <div class="ranch-grid-panel">
                        <h3>Ranch Pasture</h3>
                        <div class="pasture-info">
                            <div>Plant and harvest in your pasture to earn resources!</div>
                            <div class="resources-earned">
                                <span class="resource-item">Hay: <span id="hay-earned">0</span></span>
                                <span class="resource-item">Water: <span id="water-earned">0</span></span>
                            </div>
                        </div>
                        <div id="ranch-grid" class="grid-container">
                            <!-- 5x5 grid will be generated by JavaScript -->
                        </div>
                        <div class="grid-controls">
                            <button id="harvest-all" class="action-button">
                                <span class="icon">üåæ</span>
                                <span class="label">Harvest All</span>
                            </button>
                            <div class="growth-timer">
                                Next growth cycle: <span id="growth-timer">60</span>s
                            </div>
                        </div>
                        
                        <!-- Ranch Operations Buttons -->
                        <div class="ranch-operations-bar">
                            <div class="operations-section">
                                <h4>Ranch Operations</h4>
                                <div class="compact-buttons">
                                    <button id="breed-cattle" class="compact-button">
                                        <img src="/img/cattle.png" alt="Cattle" class="button-icon" width="24" height="24">
                                        <span class="label">Breed Cattle</span>
                                        <span class="cost">10 Hay, 10 Water</span>
                                    </button>
                                    <button id="upgrade-barn" class="compact-button">
                                        <span class="icon">üè†</span>
                                        <span class="label">Upgrade Barn</span>
                                        <span class="cost">50 $CATTLE</span>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="travel-section">
                                <h4>Travel</h4>
                                <div class="compact-buttons">
                                    <button id="go-to-saloon" class="compact-button">
                                        <span class="icon">üé∞</span>
                                        <span class="label">Saloon</span>
                                    </button>
                                    <button id="go-to-night" class="compact-button">
                                        <span class="icon">üåô</span>
                                        <span class="label">Ether Range</span>
                                    </button>
                                    <button id="go-to-profile-from-ranch" class="compact-button">
                                        <span class="icon">üë§</span>
                                        <span class="label">Profile</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Side Panel for Inventory -->
                <div class="side-section">
                    <div class="inventory-panel">
                        <h3>
                            Your Cattle
                            <button class="toggle-panel" title="Toggle inventory panel">
                                <span class="toggle-icon">‚óÄ</span>
                            </button>
                        </h3>
                        <div id="cattle-inventory" class="inventory-list">
                            <!-- Cattle inventory will be populated dynamically -->
                            <div class="empty-message">No cattle yet. Start breeding!</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Saloon Scene UI -->
        <div id="saloon-ui" class="screen hidden">
            <div class="header">
                <div class="time-indicator day">
                    <div class="icon">üé∞</div>
                    <div class="label">Cipher Gulch - Saloon</div>
                </div>
                <div class="resources">
                    <div class="resource">
                        <span class="resource-label">$CATTLE:</span>
                        <span class="resource-value" id="saloon-cattle-balance">100</span>
                    </div>
                    <div class="resource bonus-display hidden">
                        <span class="resource-label">Bonus:</span>
                        <span class="resource-value" id="bonus-amount">+0</span> $CATTLE
                    </div>
                </div>
            </div>
            
            <div class="main-content-layout">
                <!-- Main Race Track Section -->
                <div class="main-section">
                    <div class="race-panel">
                        <h3>Horse Race</h3>
                        
                        <div class="track-container">
                            <div class="starting-line"></div>
                            <div class="finish-line"></div>
                            
                            <div id="track-hearts" class="track">
                                <div class="horse-label">
                                    <img src="img/suits/heart.png" alt="Hearts" class="suit-icon">
                                </div>
                                <div class="progress-bar">
                                    <div id="hearts-progress" class="progress" style="width: 0%"></div>
                                </div>
                            </div>
                            
                            <div id="track-diamonds" class="track">
                                <div class="horse-label">
                                    <img src="img/suits/diamond.png" alt="Diamonds" class="suit-icon">
                                </div>
                                <div class="progress-bar">
                                    <div id="diamonds-progress" class="progress" style="width: 0%"></div>
                                </div>
                            </div>
                            
                            <div id="track-clubs" class="track">
                                <div class="horse-label">
                                    <img src="img/suits/club.png" alt="Clubs" class="suit-icon">
                                </div>
                                <div class="progress-bar">
                                    <div id="clubs-progress" class="progress" style="width: 0%"></div>
                                </div>
                            </div>
                            
                            <div id="track-spades" class="track">
                                <div class="horse-label">
                                    <img src="img/suits/spade.png" alt="Spades" class="suit-icon">
                                </div>
                                <div class="progress-bar">
                                    <div id="spades-progress" class="progress" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="race-card-area">
                            <div id="drawn-card" class="drawn-card">
                                <div class="card-placeholder">Draw a card to advance a horse</div>
                            </div>
                            
                            <div class="race-controls">
                                <button id="start-race" class="action-button large">
                                    <span class="icon">üèÅ</span>
                                    <span class="label">Start Race</span>
                                </button>
                                <button id="draw-card" class="action-button large" disabled>
                                    <span class="icon">üÉè</span>
                                    <span class="label">Draw Card</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Betting Controls Bar -->
                        <div class="ranch-operations-bar">
                            <div class="operations-section betting-section">
                                <h4>Place Your Bets</h4>
                                <div class="bet-buttons">
                                    <button id="bet-hearts-btn" class="bet-button" data-suit="hearts">
                                        <img src="img/suits/heart.png" alt="Hearts" class="bet-icon">
                                        <span class="odds">Odds: <span id="odds-hearts">4.0</span>x</span>
                                    </button>
                                    <button id="bet-diamonds-btn" class="bet-button" data-suit="diamonds">
                                        <img src="img/suits/diamond.png" alt="Diamonds" class="bet-icon">
                                        <span class="odds">Odds: <span id="odds-diamonds">4.0</span>x</span>
                                    </button>
                                    <button id="bet-clubs-btn" class="bet-button" data-suit="clubs">
                                        <img src="img/suits/club.png" alt="Clubs" class="bet-icon">
                                        <span class="odds">Odds: <span id="odds-clubs">4.0</span>x</span>
                                    </button>
                                    <button id="bet-spades-btn" class="bet-button" data-suit="spades">
                                        <img src="img/suits/spade.png" alt="Spades" class="bet-icon">
                                        <span class="odds">Odds: <span id="odds-spades">4.0</span>x</span>
                                    </button>
                                </div>
                                
                                <!-- Hidden bet inputs that will be shown in slider form -->
                                <div class="bet-slider-overlay hidden" id="bet-slider-overlay">
                                    <div id="bet-slider-container" class="bet-slider-container">
                                        <h5 id="bet-slider-title">Place Bet on Hearts</h5>
                                        <input type="range" id="bet-slider" class="bet-slider" min="0" max="50" value="0" step="5">
                                        <div class="bet-slider-value">
                                            <span id="bet-slider-value">0</span> $CATTLE
                                        </div>
                                        <div class="bet-slider-buttons">
                                            <button id="confirm-bet" class="confirm-bet">OK</button>
                                            <button id="cancel-bet" class="cancel-bet">Cancel</button>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bet-summary">
                                    <div class="total-bet">
                                        Total Bet: <span id="total-bet-amount">0</span> $CATTLE
                                    </div>
                                    <div class="burn-info">
                                        10% (<span id="burn-amount">0</span> $CATTLE) will be burned
                                    </div>
                                </div>
                            </div>
                            
                            <div class="travel-section">
                                <div class="bonus-and-education">
                                    <button id="claim-bonus" class="compact-button">
                                        <span class="icon">üéÅ</span>
                                        <span class="label">Claim 50 $CATTLE Bonus</span>
                                    </button>
                                    
                                    <div class="education-tip mini">
                                        <div class="icon">üìö</div>
                                        <div class="tip-content">
                                            <strong>Risk/Reward:</strong> Horses that are behind have better odds!
                                        </div>
                                    </div>
                                </div>
                                
                                <h4>Travel</h4>
                                <div class="compact-buttons">
                                    <button id="back-to-ranch" class="compact-button">
                                        <span class="icon">üè†</span>
                                        <span class="label">Ranch</span>
                                    </button>
                                    <button id="go-to-night-from-saloon" class="compact-button">
                                        <span class="icon">üåô</span>
                                        <span class="label">Ether Range</span>
                                    </button>
                                    <button id="go-to-profile" class="compact-button">
                                        <span class="icon">üë§</span>
                                        <span class="label">Profile</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Side Panel for Current Bets & History -->
                <div class="side-section">
                    <div class="inventory-panel">
                        <h3>
                            Your Bets
                            <button class="toggle-panel" title="Toggle bets panel">
                                <span class="toggle-icon">‚óÄ</span>
                            </button>
                        </h3>
                        <div id="current-bets" class="inventory-list">
                            <!-- Current bets will be populated dynamically -->
                            <div id="bets-hearts" class="bet-record" data-suit="hearts">
                                <img src="img/suits/heart.png" alt="Hearts" class="bet-record-icon">
                                <span class="bet-amount" id="hearts-bet-display">0</span> $CATTLE
                            </div>
                            <div id="bets-diamonds" class="bet-record" data-suit="diamonds">
                                <img src="img/suits/diamond.png" alt="Diamonds" class="bet-record-icon">
                                <span class="bet-amount" id="diamonds-bet-display">0</span> $CATTLE
                            </div>
                            <div id="bets-clubs" class="bet-record" data-suit="clubs">
                                <img src="img/suits/club.png" alt="Clubs" class="bet-record-icon">
                                <span class="bet-amount" id="clubs-bet-display">0</span> $CATTLE
                            </div>
                            <div id="bets-spades" class="bet-record" data-suit="spades">
                                <img src="img/suits/spade.png" alt="Spades" class="bet-record-icon">
                                <span class="bet-amount" id="spades-bet-display">0</span> $CATTLE
                            </div>
                        </div>
                        
                        <h3>Recent Results</h3>
                        <div id="results-history" class="results-list">
                            <!-- Results will be added here -->
                            <div class="empty-message">No race results yet.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Profile UI -->
        <div id="profile-ui" class="screen hidden">
            <div class="header">
                <div class="time-indicator day">
                    <div class="icon">üë§</div>
                    <div class="label">Character Profile</div>
                </div>
                <div class="resources">
                    <div class="resource">
                        <span class="resource-label">$CATTLE:</span>
                        <span class="resource-value" id="profile-cattle-balance">100</span>
                    </div>
                </div>
            </div>
            
            <div class="profile-layout">
                <div class="character-panel">
                    <h3>Your Character</h3>
                    <div class="character-customization">
                        <div class="character-preview">
                            <div class="current-character">
                                <img id="character-image" src="img/characters/the-kid.jpeg" alt="Character">
                            </div>
                        </div>
                        
                        <div class="character-info">
                            <div class="input-group">
                                <label for="character-name">Character Name:</label>
                                <input type="text" id="character-name" value="Cowboy">
                            </div>
                            
                            <div class="character-selection">
                                <h4>Choose Character Type:</h4>
                                <div class="character-options">
                                    <div class="character-option selected" data-character="the-kid">
                                        <img src="img/characters/the-kid.jpeg" alt="The Kid" class="character-thumbnail">
                                        <div class="character-name">The Kid</div>
                                    </div>
                                    <div class="character-option" data-character="the-hacker">
                                        <img src="img/characters/the-hacker.jpeg" alt="The Hacker" class="character-thumbnail">
                                        <div class="character-name">The Hacker</div>
                                    </div>
                                    <div class="character-option" data-character="the-scientist">
                                        <img src="img/characters/the-scientist.jpg" alt="The Scientist" class="character-thumbnail">
                                        <div class="character-name">The Scientist</div>
                                    </div>
                                </div>
                            </div>
                            
                            <button id="save-profile" class="primary-button">Save Changes</button>
                        </div>
                    </div>
                </div>
                
                <div class="stats-panel">
                    <h3>Player Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-label">Races Won</div>
                            <div class="stat-value" id="races-won">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Races Lost</div>
                            <div class="stat-value" id="races-lost">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Cattle Bred</div>
                            <div class="stat-value" id="cattle-bred">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Potions Crafted</div>
                            <div class="stat-value" id="potions-crafted">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Total $CATTLE Earned</div>
                            <div class="stat-value" id="total-earned">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Total $CATTLE Burned</div>
                            <div class="stat-value" id="total-burned">0</div>
                        </div>
                    </div>
                </div>
                
                <div class="navigation-menu">
                    <h4>Navigation</h4>
                    <div class="nav-buttons">
                        <button id="back-to-ranch-from-profile" class="secondary-button">
                            <span class="icon">üè†</span>
                            <span class="label">Ranch</span>
                        </button>
                        <button id="go-to-saloon-from-profile" class="secondary-button">
                            <span class="icon">üé∞</span>
                            <span class="label">Saloon</span>
                        </button>
                        <button id="go-to-night-from-profile" class="secondary-button">
                            <span class="icon">üåô</span>
                            <span class="label">Ether Range</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Night Market Scene UI -->
        <div id="night-ui" class="screen hidden">
            <div class="header">
                <div class="time-indicator night">
                    <img src="img/brb-logo.png" alt="BRB Logo" class="game-logo" style="width: 24px; height: auto; vertical-align: middle; margin-right: 8px; display: inline-block;">
                    <div class="icon">üåô</div>
                    <div class="label">Ether Range - Night</div>
                </div>
                <div class="resources">
                    <div class="resource">
                        <span class="resource-label">$CATTLE:</span>
                        <span class="resource-value" id="night-cattle-balance">100</span>
                    </div>
                    <div class="resource">
                        <span class="resource-label">Market:</span>
                        <span class="resource-value" id="market-multiplier">1.0</span>x
                    </div>
                </div>
            </div>
            
            <div class="main-content-layout">
                <!-- Main Shadow Market Lab Section -->
                <div class="main-section">
                    <div class="shadow-market-panel">
                        <h3>Shadow Market Laboratory</h3>
                        <div class="market-info">
                            <div>Craft and distill shadow potions in your lab to earn resources!</div>
                            <div class="resources-earned">
                                <span class="resource-item">Ether: <span id="ether-earned">0</span></span>
                                <span class="resource-item">Multiplier: <span id="market-multiplier-value">x1.0</span></span>
                            </div>
                        </div>
                        <div class="network-status">
                            <div id="market-state">Network: Stable</div>
                            <div id="market-tip">Normal crystal yield</div>
                        </div>
                        
                        <!-- Grid will be generated entirely by JavaScript -->
                        <div id="shadow-grid" class="grid-container">
                            <!-- 4x4 grid will be generated by JavaScript -->
                        </div>
                        
                        <div class="grid-controls">
                            <button id="distill-all" class="action-button">
                                <span class="icon">‚öóÔ∏è</span>
                                <span class="label">Distill All</span>
                            </button>
                            <div class="market-cycle">
                                Market Cycle: <span id="market-cycle">Stable</span>
                            </div>
                        </div>
                        
                        <!-- Market Operations Bar -->
                        <div class="ranch-operations-bar">
                            <div class="operations-section">
                                <h4>Shadow Market</h4>
                                <div class="compact-buttons">
                                    <button id="craft-potion" class="compact-button">
                                        <span class="icon">üß™</span>
                                        <span class="label">Craft Potion</span>
                                        <span class="cost">20 $CATTLE (50% burn)</span>
                                    </button>
                                </div>
                                
                                <div class="education-tip mini">
                                    <div class="icon">üìö</div>
                                    <div class="tip-content">
                                        <strong>Market Economics:</strong> Shadow Potion prices vary based on market conditions. 
                                        Timing your sales during high market periods maximizes profits.
                                    </div>
                                </div>
                            </div>
                            
                            <div class="travel-section">
                                <h4>Travel</h4>
                                <div class="compact-buttons">
                                    <button id="back-to-ranch-night" class="compact-button">
                                        <span class="icon">üè†</span>
                                        <span class="label">Ranch</span>
                                    </button>
                                    <button id="go-to-saloon-from-night" class="compact-button">
                                        <span class="icon">üé∞</span>
                                        <span class="label">Saloon</span>
                                    </button>
                                    <button id="go-to-profile-from-night" class="compact-button">
                                        <span class="icon">üë§</span>
                                        <span class="label">Profile</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Side Panel for Inventory -->
                <div class="side-section">
                    <div class="inventory-panel">
                        <h3>
                            Your Potions
                            <button class="toggle-panel" title="Toggle inventory panel">
                                <span class="toggle-icon">‚óÄ</span>
                            </button>
                        </h3>
                        <div id="potion-inventory" class="inventory-list">
                            <!-- Potion inventory will be populated dynamically -->
                            <div class="empty-message">No potions yet. Start crafting!</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Notifications -->
        <div id="notification" class="hidden">
            <div class="content"></div>
        </div>
        
        <!-- Result Modal -->
        <div id="result-modal" class="modal hidden">
            <div class="modal-content">
                <div class="result-header">
                    <h3 id="result-title">Result</h3>
                </div>
                <div class="result-body">
                    <p id="result-message"></p>
                </div>
                <div class="result-footer">
                    <button id="close-result" class="primary-button">OK</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Win Celebration Animation -->
    <div class="win-celebration hidden" id="win-celebration">
        <div class="win-message">Winner!</div>
        <div class="win-amount" id="win-amount">+0 $CATTLE</div>
    </div>
    
    <!-- Scripts -->
    <!-- Third-party libraries -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.55.2/dist/phaser.min.js"></script>
    
    <!-- Core UI utilities -->
    <script src="js/confetti.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/asset-preloader.js"></script>
    
    <!-- Game mechanics (Phaser scenes and objects) -->
    <script src="js/menu-scene.js"></script>
    <script src="js/main-menu-scene.js"></script>
    <script src="js/night-scene.js"></script>
    <script src="js/shadow-grid-cells.js"></script>
    
    <!-- Core game components -->
    <script src="js/notifications.js"></script>
    <script src="js/confetti.js"></script>
    <script src="js/shadow-market-renderer.js"></script>
    <script src="js/scene-initializer.js"></script>
    
    <!-- Critical fixes for the game -->
    <script src="js/critical-fixes.js"></script>
    
    <!-- Tutorial system -->
    <script src="js/tutorial-system.js"></script>
    
    <!-- Fixed components -->
    <script src="js/saloon-scene-fixed.js"></script>
    <script src="js/racing-game-fixed.js"></script>
    
    <!-- Improved racing implementation -->
    <script src="js/racing-game-improved.js"></script>
    
    <!-- Fixed standalone racing implementation - this one has the latest fixes -->
    <script src="js/racing-game-standalone-fixed.js"></script>
    
    <!-- Standalone racing implementation -->
    <script src="js/saloon-standalone.js"></script>
    <script src="js/racing-game-standalone.js"></script>
    
    <!-- Complete Phaser implementation for Saloon -->
    <script src="js/saloon-scene-complete.js"></script>
    
    <!-- Original game with overrides -->
    <script src="js/game.js"></script>
    
    <!-- Graphics enhancements -->
    <script src="js/ranch-graphics.js"></script>
    <script src="js/shadow-grid-graphics.js"></script>
    
    <!-- Game features -->
    <script src="js/cattle-breeding.js"></script>
    <script src="js/potion-crafting.js"></script>
    <script src="js/potion-effects.js"></script>
    
    <!-- UI navigation and fallbacks -->
    <script src="js/game-fixed.js"></script>
    
    <!-- Game initialization (must be last) -->
    <script src="js/game-init.js"></script>
</body>
</html>